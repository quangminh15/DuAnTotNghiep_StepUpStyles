<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{/users/layout_user :: content(~{::body},~{::title})}">

<head>

<title>SUS || CHI TIẾT</title>

</head>

<body ng-controller="favorite-ctrl">

	<div class="right-sidebar-panel-content animated fadeInRight"
		tabindex="5003" style="overflow: hidden; outline: none;"></div>
	<section class="w3l-ecommerce-main-inn">
		<!--/ecommerce-single-->
		<div class="ecomrhny-content-inf py-5">
			<div class="container py-lg-5">
				<!--/row1-->
				<!-- NG-APP CART -->
				<div ng-controller="cart-ctrl" class="sp-store-single-page row">
					<div class="col-lg-5 single-right-left">
						<div class="flexslider1">
							<ul class="slides">
								<th:block th:each="image, iterStat : ${productImageList}">
									<li th:attr="data-thumb=${image.imagePath}"
										th:if="${iterStat.count} &lt;= 4">
										<div class="thumb-image">
											<img th:src="@{${image.imagePath}}" data-imagezoom="true"
												class="img-fluid" alt=" ">
										</div>
									</li>
								</th:block>
							</ul>
							<div class="clearfix"></div>
						</div>
						<div class="eco-buttons mt-5">

							<div class="transmitv single-item">
								<form action="#" method="post">
									<button type="submit"
										ng-click="addToCart(productDetails.productID, size, color, qty)"
										class="transmitv-cart ptransmitv-cart add-to-cart read-2">
										Thêm vào giỏ</button>
								</form>
							</div>
							<div class="buyhny-now">
								<a href="#buy" class="action btn">Mua ngay </a>
							</div>

						</div>
					</div>
					<div class="col-lg-7 single-right-left pl-lg-4">
						<h3>{{ productDetails.productName }}</h3>
						<div class="caption">
							<ul class="rating-single">
								<li ng-repeat="star in getStarToAvgs(averageRating)">
									<span ng-class="star" aria-hidden="true"></span>
								</li>
								<li>{{ averageRating }}/5<span
									class="fa fa-star yellow-star" aria-hidden="true"></span>
								</li>
							</ul>
							<p>{{ numRatings }} đánh giá</p>

							<h6 style="white-space: nowrap;"
								ng-if="productDetails.discount[0].priceDiscount == null">
								<span class="item_price">{{ productDetails.price |
									number:0 }} ₫</span>
							</h6>

							<h6
								style="display: flex; align-items: center; width: 100%; white-space: nowrap;"
								ng-if="productDetails.discount[0].status === 'Đang diễn ra' && productDetails.discount[0].priceDiscount">
								<del style="margin-right: 10px;">{{ productDetails.price |
									number:0 }} ₫</del>
								<span class="item_price">{{
									productDetails.discount[0].priceDiscount | number:0 }} ₫</span>
							</h6>

							<h6 style="white-space: nowrap;"
								ng-if="productDetails.discount[0].status !== 'Đang diễn ra' && productDetails.discount[0].priceDiscount">
								<span class="item_price">{{ productDetails.price |
									number:0 }} ₫</span>
							</h6>
						</div>
						<div class="desc_single my-4">
							<span class="col-md-3 size1">Size</span>
							<div class="col-md-9">
								<select ng-model="size" ng-change="setSelectedSize(size.sizeNumber)" class="form-control">
									<option value="" disabled selected>-- Chọn size --</option>
									<option ng-repeat="s in sizess" ng-value="{{s}}">{{s.sizeNumber}}</option>
								</select>
								
							</div>
						</div>

						<div class="desc_single my-4">
							<span class="col-md-3 size1">Màu sắc</span>
							<div class="col-md-9">
								<select  ng-model="color" class="form-control"  ng-change="showQuantityStock(productDetails.productID, size.sizeID, color.colorID)">
									<option value="" disabled selected>-- Chọn size --</option>
									<option ng-repeat="c in filteredColors" ng-value="{{c}}">{{c.colorName}}</option>
								</select>
							</div>
						</div>


						<div class="desc_single my-4">
							<span class="col-md-3 size1">Số lượng</span>
							<div class="col-md-9">
								<input ng-value="1" ng-change="checkQuantity(qty)" ng-model="qty" type="number"
									class="form-control">
							</div>
							<p class="col-md-12 size1">Số lượng Trong Kho: {{singleProd.quantity}}</p>
						</div>

						<div class="desc_single mb-4">
							<h5>Mô tả:</h5>
							<p>{{ productDetails.description }}</p>
						</div>

						<div class="description mb-4">
							<h5>Điền mã giảm giá để được hưởng ưu đãi</h5>
							<form action="#" class="d-flex" method="post">
								<input type="text" placeholder="Mã giảm giá" required>
								<button class="submit btn" type="submit">OK</button>
							</form>
						</div>

					</div>
				</div>
			</div>
			<!--//row1-->
		</div>
		<!--//ecommerce-single-->
	</section>
	<section class="w3l-ecommerce-main w3l-ecommerce-main-inn">
		<!-- /content-6-section -->
		<div class="content-singlev-ecomm py-5">
			<div class="container py-lg-5">
				<div class="two-products-single row">
					<div class="col-md-6 pro-grid-left">
						<div class="pro-grid-one">
							<div class="product-des-hny">
								<h4 class="text-wthree">
									Thời trang nữ giới <br>Siêu hot
								</h4>
								<a href="/list_products" class="read-more-btn2 btn"> Xem
									ngay </a>
							</div>
						</div>
					</div>

					<div class="col-md-6 pro-grid-right">
						<div class="pro-grid-one pro-grid-two">
							<div class="product-des-hny">
								<h4 class="text-wthree">
									Thời trang nam giới <br>Siêu hot
								</h4>
								<a href="/list_products" class="read-more-btn2 btn"> Xem
									ngay </a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- //content-6-section -->
	<section class="w3l-ecommerce-main">
		<!-- /products-->
		<div class="ecom-contenthny py-5">
			<div class="container py-lg-5">
				<div style="margin: 8px auto; display: block; text-align: center;">

					<!---728x90--->


				</div>
				<h3 class="hny-title mb-0 text-center">
					SẢN PHẨM <span>TƯƠNG TỰ</span>
				</h3>
				<p class="text-center">Có thể sẽ phù hợp với bạn</p>
				<div style="margin: 8px auto; display: block; text-align: center;">

					<!---728x90--->

				</div>
				<!-- /row-->
				<div class="ecom-products-grids row mt-lg-5 mt-3">
					<div ng-repeat="p in productDetailss"
						class="col-lg-3 col-6 product-incfhny mt-4">
						<div class="product-grid2 transmitv"
							ng-click="saveProductID(p.productID)">
							<div class="product-image2" style="position: relative;">
								<div class="discount-circle"
									ng-if="p.discount[0].status === 'Đang diễn ra' && p.discount[0].priceDiscount">{{
									p.discount[0].directDiscount }}%</div>
								<a ng-click="goToSinglePage(p.productID)"> <img
									class="pic-1 img-fluid" ng-src="{{p.image[0].imagePath}}">
									<img ng-if="p.image.length > 1" class="pic-2 img-fluid"
									ng-src="{{p.image[1].imagePath}}"> <img
									ng-if="p.image.length <= 1" class="pic-2 img-fluid"
									ng-src="{{p.image[0].imagePath}}">
								</a>
								<ul class="social">
									<li> 
										<span ng-if="isFavorited(p.productID)" ng-click="check(p.productID)" class="fa fa-heart liked" style="font-size: 24px; color: red;"></span>
										<span ng-if="!isFavorited(p.productID)" ng-click="check(p.productID)" class="fa fa-heart-o not-liked" style="font-size: 24px; color: red; font-weight: bold;"></span>
									</li>
								</ul>
								<div class="transmitv single-item">
									<a ng-click="goToSinglePage(p.productID)" type="submit"
										class="transmitv-cart ptransmitv-cart add-to-cart"> Xem
										chi tiết </a>
								</div>
							</div>
							<div class="product-content">
								<h3 class="title">
									<a ng-click="goToSinglePage(p.productID)">{{ p.productName
										}}</a>
								</h3>
								<span class="price" ng-if="p.discount[0].priceDiscount == null">
									{{ p.price | number:0 }} ₫</span> <span class="price"
									ng-if="p.discount[0].status === 'Đang diễn ra' && p.discount[0].priceDiscount">
									<del>{{ p.price | number:0 }} ₫</del> {{
									p.discount[0].priceDiscount | number:0 }} ₫
								</span> <span class="price"
									ng-if="p.discount[0].status !== 'Đang diễn ra' && p.discount[0].priceDiscount">
									{{ p.price | number:0 }} ₫ </span>
							</div>
						</div>
					</div>
				</div>

				<!-- //row-->
			</div>
		</div>
	</section>
	<!-- //products-->

	<!--review-->
	<section class="w3l-ecommerce-main w3l-ecommerce-main-inn">
		<!-- /content-6-section -->
		<div class="container content-singlev-ecomm py-5">
			<h4>ĐÁNH GIÁ SẢN PHẨM</h4>
			<div class="content-singlev-ecomm py-5 bg-white">
				<div class="row wrapper-rating">
					<div class="col-sm-3 text-center">
						<h2>
							{{averageRating}}/5<span class="text-warning">★</span>
						</h2>
					</div>
					<div class="col-sm-8">
						<p class="d-inline-flex gap-1">
							<div class="btn mx-2 btn-outline-warning" style="background-color: white; color: #ff7315;" ng-click="filterByRating(null)">Tất cả ({{ reviewCounts.total }})</div>
							<a class="btn mx-2 btn-outline-warning" style="background-color: white; color: #ff7315;" ng-click="filterByRating(5)">5 sao ({{ reviewCounts[5] }})</a>
							<a class="btn mx-2 btn-outline-warning" style="background-color: white; color: #ff7315;" ng-click="filterByRating(4)">4 sao ({{ reviewCounts[4] }})</a>
							<a class="btn mx-2 btn-outline-warning" style="background-color: white; color: #ff7315;" ng-click="filterByRating(3)">3 sao ({{ reviewCounts[3] }})</a>
							<a class="btn mx-2 btn-outline-warning" style="background-color: white; color: #ff7315;" ng-click="filterByRating(2)">2 sao ({{ reviewCounts[2] }})</a>
							<a class="btn mx-2 btn-outline-warning" style="background-color: white; color: #ff7315;" ng-click="filterByRating(1)">1 sao ({{ reviewCounts[1] }})</a>
						</p>
					</div>					
				</div>
			</div>
			<div class="content-singlev-ecomm py-3" ng-repeat="rv in allreviews">
				<div class="row">
					<div class="col-sm-2 text-center">
						<img src="link_to_user_image.jpg" alt="Hình"
							class="img-fluid rounded-circle">
					</div>
					<div class="col-sm-10">
						<p class="mb-0">
							<strong>{{rv.user.fullName}}</strong>
						</p>
						<p class="mb-0">{{rv.reviewDate | date:'dd-MM-yyyy'}}</p>
						<div class="rating mb-2">
							<span class="fa fa-star" ng-repeat="star in getStars(rv.rating)"></span>
						</div>
						<p class="mb-0" style="word-wrap: break-word;">{{rv.title}}</p>
						<span class="fa fa-thumbs-up"></span>
					</div>
				</div>
				<hr>
			</div>
			<!--/pagination-->
			<div class="pagination" style="margin: 0px 10px 20px;">
				<ul>
					<li class="prev"><a ng-click="reviewPager.first()"><span
							class="fa fa-angle-double-left"></span></a></li>
					<li class="page-item" ng-repeat="page in reviewVisiblePages"
						ng-class="{ 'active': (page.value === reviewPager.page + 1) }"><a
						class="page-link" href="" ng-click="reviewPager.gotoReview(page.value)"
						ng-style="page.value === (reviewPager.page + 1) ? { 'background': 'orangered', 'border-color': 'orangered' } : {}">
							{{ page.value }} </a></li>
					<li class="next"><a ng-click="reviewPager.last()"><span
							class="fa fa-angle-double-right"></span></a></li>
				</ul>
			</div>
			<!--//pagination-->
		</div>
		</div>
	</section>
	<!--review-->

	<div style="margin: 8px auto; display: block; text-align: center;">

		<!---728x90--->

	</div>
</body>

</html>